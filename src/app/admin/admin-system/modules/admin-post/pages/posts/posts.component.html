<section class="grid-section">
  <div class="top-section my-4">
    <div class="title">
      <h4 class="fw-bold">{{ 'blogPosts' | translate }}</h4>
    </div>
    <div class="create-post-btn d-flex justify-content-end" *ngIf="canCreateBlog">
      <a [routerLink]="'/blog/post/create'"  class="btn btn-primary">
        {{ 'createBlogPost' | translate }}
      </a>
    </div>
  </div>

  <div class="bottom-section">
    <dx-data-grid
      [columnAutoWidth]="true"
      [columnHidingEnabled]="true"
      id="gridContainer"
      [dataSource]="posts"
      [remoteOperations]="false"
      [allowColumnReordering]="true"
      [rowAlternationEnabled]="true"
      [showBorders]="true"
      [width]="'100%'"
      (onContentReady)="contentReady($event)"
      (onInitialized)="onInitGrid($event)"
    >
      <dxo-toolbar>
        <dxi-item name="searchPanel" ></dxi-item>
      </dxo-toolbar>

      <dxo-paging [pageSize]="10"></dxo-paging>
      <dxo-pager
        [visible]="true"
        [showPageSizeSelector]="true"
        [allowedPageSizes]="[10, 25, 50, 100]"
      ></dxo-pager>

      <dxi-column dataField="id" alignment="left" [caption]="'id' | translate"></dxi-column>

      <dxi-column
        dataField="blogImage.uniqueName"
        [caption]="'featuredImage' | translate"
        [allowSorting]="false"
        [allowFiltering]="false"
        cellTemplate="imageCellTemplate"
      ></dxi-column>

      <div *dxTemplate="let data of 'imageCellTemplate'">
        <img
          [src]="[getUrl + data.value]"
          style="width: 50px; height: 50px; object-fit: cover; border-radius: 6px;"
        />
      </div>

      <dxi-column
        dataField="title"
        [caption]="'title' | translate"
        alignment="left"
      ></dxi-column>

      <dxi-column
        dataField="userId"
        [caption]="'user' | translate"
        dataType="string"
        [width]="150"
      ></dxi-column>
        <dxi-column
        dataField="user.firstName"
        [caption]="'blogAuthor' | translate"
        dataType="string"
        [width]="150"
      ></dxi-column>

     <dxi-column
        dataField="isActive"
        [caption]="'status' | translate"
        dataType="boolean"
        alignment="left"
        cellTemplate="statusCell">
    </dxi-column>

<!-- Use the same syntax as imageCellTemplate -->
<div *dxTemplate="let cellData of 'statusCell'">
  <span
    [ngClass]="{
      'active-status': cellData.value,
      'inactive-status': !cellData.value
    }"
  >
    {{ cellData.value ? 'Published' : 'Unpublished' }}
  </span>
</div>

    <dxi-column
        caption="{{ 'comments' | translate }}"
        alignment="left"
        cellTemplate="citiesTemplate"
      >
    </dxi-column>

      <div *dxTemplate="let data of 'citiesTemplate'">
        <a (click)="goToComments(data.data.id)" class="link-style">
          {{ 'comments' | translate }}
        </a>
      </div>


      <dxo-search-panel [visible]="true" [highlightCaseSensitive]="true"  
      [placeholder]="'search' | translate"></dxo-search-panel>
      <dxi-column
        *ngIf="canEditOrDelete"
        caption="{{'Actions' | translate}}"
        [width]="120"
        [allowSorting]="false"
        [allowFiltering]="false"
        cellTemplate="actionTemplate">
      </dxi-column>

     <div *dxTemplate="let data of 'actionTemplate'" class="d-flex gap-2">
      <button
        *ngIf="canUpdateBlog"
        class="btn btn-sm btn-outline-primary"
        (click)="editRow(data.data.id)"
        >
        <i class="dx-icon-edit" ></i>
      </button>

      <button
        *ngIf="canDeleteBlog"
        class="btn btn-sm btn-outline-danger"
        (click)="deleteDialog(data.data.id)"      
       >
        <i class="dx-icon-trash"></i>
      </button>
    </div> 
    </dx-data-grid>
  </div>
</section>
