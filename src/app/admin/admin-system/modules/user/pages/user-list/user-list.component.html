<section class="grid-section">
  <div class="top-section my-4">
    <div class="title" >
      <h4 class="fw-bold">{{ 'sidebarUsers' | translate }}</h4>
    </div>
    <div class="create-post-btn d-flex justify-content-end" *ngIf="canCreateUser">
      <a class="btn btn-primary" [routerLink]="'/admin/users/list/create'">
        {{ 'createUser' | translate }}
      </a>
    </div>
  </div>
  <div class="bottom-section">
    <dx-data-grid
      #grid
      [columnAutoWidth]="true"
      [columnHidingEnabled]="true"
      id="gridContainer"
      [dataSource]="users"
      [remoteOperations]="false"
      [allowColumnReordering]="true"
      [rowAlternationEnabled]="true"
      [showBorders]="true"
      [width]="'100%'"
      (onContentReady)="contentReady($event)"
    >
      <dxo-toolbar>

        <!-- Search Panel -->
        <dxi-item name="searchPanel"></dxi-item>
      </dxo-toolbar>

      <dxo-paging [pageSize]="10"></dxo-paging>
      <dxo-pager
        [visible]="true"
        [showPageSizeSelector]="true"
        [allowedPageSizes]="[10, 25, 50, 100]"
      ></dxo-pager>

      <dxi-column dataField="id" alignment="left" caption="{{ 'id' | translate }}">
      </dxi-column>

      <dxi-column
        dataField="image"
        [caption]="'featuredImage' | translate"
        [allowSorting]="false"
        [allowFiltering]="false"
        cellTemplate="imageCellTemplate"
      ></dxi-column>

      <div *dxTemplate="let data of 'imageCellTemplate'">
        <img
          [src]="getUrl + data.data.image"
          style="width: 50px; height: 50px; object-fit: cover; border-radius: 6px;"
        />
      </div>

      <dxi-column dataField="firstName" dataType="string" caption="{{ 'name' | translate }}">
      </dxi-column>

       <dxi-column dataField="lastName" dataType="string" caption="{{ 'lastName' | translate }}">
      </dxi-column>

      <dxi-column dataField="email" dataType="string" caption="{{ 'email' | translate }}">
      </dxi-column>
      <dxi-column
        *ngIf="canEditOrDelete"
        caption="{{'Actions' | translate}}"
        [width]="120"
        [allowSorting]="false"
        [allowFiltering]="false"
        cellTemplate="actionTemplate">
      </dxi-column>

     <div *dxTemplate="let data of 'actionTemplate'" class="d-flex gap-2">
      <button
        *ngIf="canUpdateUser"
        class="btn btn-sm btn-outline-primary"
        (click)="editRow(data.data.id)"
        >
        <i class="dx-icon-edit"></i>
      </button>

      <button
        *ngIf="canDeleteUser"
        class="btn btn-sm btn-outline-danger"
        (click)="deleteDialog(data.data.id)" 
      
>
        <i class="dx-icon-trash"></i>
      </button>
    </div> 

      <!-- <dxi-column type="buttons" [width]="100" *ngIf="permission.hasAny([permissions.userDelete, permissions.userUpdate])">
          <dxi-button
            hint="Edit"
            icon="edit"
            [onClick]="editRow.bind(this)"
          ></dxi-button>
          <dxi-button name="delete" *ngIf="permission.has(permissions.userDelete)"></dxi-button>
      </dxi-column> -->
      <dxo-search-panel [visible]="true" [highlightCaseSensitive]="true"  [placeholder]="'search' | translate"></dxo-search-panel>

      <div *dxTemplate="let d of 'discountCellTemplate'">
        <div class="chart-cell">
          <dx-bullet
            [showTarget]="false"
            [showZeroLevel]="true"
            [startScaleValue]="0"
            [endScaleValue]="100"
            [value]="d.value * 100"
          >
            <dxo-size [width]="150" [height]="35"></dxo-size>
            <dxo-margin [top]="5" [bottom]="0" [left]="5"></dxo-margin>
          </dx-bullet>
        </div>
      </div>
    </dx-data-grid>
  </div>
</section>

